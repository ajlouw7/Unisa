\documentclass[10pt,a4paper]{article}
\usepackage[natbibapa]{apacite} 
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage[a4paper,margin=0.8in]{geometry} 

%opening
\title{COS 4892 Assignment 2}
\author{Adriaan Louw (53031377)}

\newcommand{\interp}{I}
\providecommand{\floor}[1]{\lfloor #1 \rfloor  }

\newcommand{\en}{\wedge}
\newcommand{\of}{\vee}
\begin{document}

\maketitle

\section{Question 1}

We will define

\begin{equation}
\label{q1}
Q = ((Q_1 \wedge B) \vee (Q_2 \wedge \neg B))
\end{equation}

Now we calculate from Equation \ref{q1}

\begin{equation}
\begin{split}
 Q\wedge B &= ((Q_1\wedge B)\vee(Q_2\wedge B))\wedge B\\
 &= (Q_1\wedge B \wedge B)\vee (Q_2\wedge \neg B \wedge B)\\
 &= Q_1\wedge B
 \end{split}
\end{equation}

and

\begin{equation}
\begin{split}
 Q\wedge B &= ((Q_1\wedge B)\vee(Q_2\wedge B))\wedge B\\
 &= (Q_1\wedge B \wedge \neg B)\vee (Q_2\wedge \neg B \wedge \neg B)\\
 &= Q_2\wedge \neg B
 \end{split}
\end{equation}

















\section{Question 2.1}

\begin{equation}
\{?\} x:=3.2z\{wy-2w^2<z\} 
\end{equation}

\begin{equation}
\{wy-2w^2<z\}  x:=3.2z\{wy-2w^2<z\} 
\end{equation}

The post condition is not dependant on $x$. Thus there is notihing to replace by using the assignment Axiom

\section{Question 2.2}

\begin{equation}
 \{?\} x:=x-1;y:=y-1\{z-1\leq y < x \leq w\}
\end{equation}

\begin{equation}
 \{z-1\leq y-1<x-1\leq w\} x:=x-1;y:=y-1\{z-1\leq y < x \leq w\}
\end{equation}

\begin{equation}
 \{z\leq y<x\leq w+1\} x:=x-1;y:=y-1\{z-1\leq y < x \leq w\}
\end{equation}

\section{Question 2.3}
\begin{equation}
 \{?\} if  even(x) \rightarrow x:=x-1 else  odd(x) \rightarrow z:= z+yx\{x\geq 0 \wedge z + yx = ab \}
\end{equation}




Using the retrogressive theorem for the if statement:

Taking the case as of $S1 = even(x)\rightarrow x:=x-1$

\begin{equation}
 \{?\}x:x-1\{x\geq 0 \wedge z + yx = ab \}
\end{equation}


\begin{equation}
\{x\geq 0 \wedge z + y(x-1) = ab \}x:x-1\{x\geq 0 \wedge z + yx = ab \}
\end{equation}


\begin{equation}
\{x\geq 0 \wedge z + yx-y = ab \}x:x-1\{x\geq 0 \wedge z + yx = ab \}
\end{equation}

Taking the case as of $S2 = odd(x)\rightarrow z:=z+yx$

\begin{equation}
 \{?\}z:z+yx\{x\geq 0 \wedge z + yx = ab \}
\end{equation}

\begin{equation}
\{x\geq 0 \wedge (z+yx) + yx = ab \}z:z+yx\{x\geq 0 \wedge z + yx = ab \}
\end{equation}

\begin{equation}
\{x\geq 0 \wedge z+ 2yx = ab \}z:z+yx\{x\geq 0 \wedge z + yx = ab \}
\end{equation}

Now applying the retrogressive theorem for the if statement
\begin{equation}
\begin{split}
 \{(x\geq 0 \wedge z + yx-y = ab \wedge even(x) )\vee (x\geq 0 \wedge z+ 2yx = ab \wedge odd(x))\}\\ if  even(x) \rightarrow x:=x-1 else  odd(x) \rightarrow z:= z+yx \\ \{x\geq 0 \wedge z + yx = ab \}
\end{split}
 \end{equation}

\section{Question 2.4}

\begin{equation}
 \{?\} while 0 \geq c \geq -2 do x:=x-1 endwhile \{x=-3\}
\end{equation}

\begin{equation}
 B = 0 \geq c \geq -2
\end{equation}

\begin{equation}
 S =  x:=x-1
\end{equation}

Starting with 

\begin{equation}
\begin{split}
 \{Z_0\}&S^0\{\neg B\}\\
 \{B \wedge C_0\}&x:=x-1\{x=-3\}\\
 \{ 0 \geq x \geq -2\wedge x-1=-3\}&x:=x-1\{x=-3\}\\
 \{ 0 \geq x \geq -2\wedge x=-2\}&x:=x-1\{x=-3\}\\
\end{split}
 \end{equation}

\begin{equation}
\begin{split}
 \{Z_1\}&S\{Z_0\}\\
  \{ 0 \geq x \geq -2\wedge x-1=-2\}&x:=x-1\{0 \geq c \geq -2\wedge x=-2\}\\
    \{ 0 \geq x \geq -2\wedge x=-1\}&x:=x-1\{0 \geq c \geq -2\wedge x=-2\}\\
\end{split}
  \end{equation}

\begin{equation}
\begin{split}
 \{Z_2\}&S\{Z_1\}\\
  \{  0 \geq x \geq -2\wedge x-1=-1\}&x:=x-1\{ 1 \geq x \geq -1\wedge x=-1\}\\
    \{  0 \geq x \geq -2\wedge x=0\}&x:=x-1\{ 1 \geq x \geq -1\wedge x=-1\}\\
\end{split}
  \end{equation} 

  
\begin{equation}
\begin{split}
 \{Z_3\}&S\{Z_2\}\\
  \{  0 \geq x \geq -2\wedge x-1=0\}&x:=x-1 \{ 2 \geq x \geq 0\wedge x=0\}\\
    \{ 0 \geq x \geq -2\wedge x=1\}&x:=x-1 \{ 2 \geq x \geq 0\wedge x=0\}\\
\end{split}
  \end{equation} 


$Z_3$ is false thus the preconditions of S are

\begin{equation}
\begin{split}
 &\{Z_0 \vee Z_1 \vee Z_2\}\\
 &\{(0 \geq x \geq -2\wedge x=-2)\vee (0 \geq x \geq -2\wedge x=-1)\vee( 0 \geq x \geq -2\wedge x=0)\}
 \end{split}
\end{equation}

\section{Question 3}

A Hoare triple ,\{P\}S\{Q\}, is valid if before execution statement s, P is valid and directly after executing S, Q is valid. Therefor for each possible value of P, statement S has to be exercuted and determined whether the result causes Q to be valid or not.  

\section{Question 4}

In this example P can have value of  x = 3, x= -3, x = 4 or x=-4. In the the first case when x = 3, after applying the statement we get y = 3. For the case of x = -3 then y = 3. When x = 4 the results in y = 4 and for x = -4, after apllying the if statement, y = 4. In each of the 4 cases the value of y is within the range defined by the postcondition. Thus the statement is valid.   

\section{Question 5.1}

The programmer specified the loop invariant as:

\begin{equation}
 n \in Z \wedge k \in Z \wedge 1\leq k \leq n+1 \wedge i = 1^{k-1}A(i)\neq X
\end{equation}

n and k must be integers because they were integers in the precondition and their type cannot be changed.

We know that tyhe invariant should contain 

\begin{equation}
 <\sum k: 1 \leq k \leq n \wedge A(i)\neq X:1> \wedge <\sum k:k=n+1:1>
\end{equation}

because the loops starts with k = 1 up to n where A(i) is not equal to X and k is larger than n for the end condition.

thus


\begin{equation}
\begin{split}
 <\sum k: 1 \leq k \leq n \wedge A(i)\neq X:1> \wedge <\sum k:k=n+1:1> &= \\
 <\sum k:1 \leq k \leq n \wedge A(i)\neq X \vee k=n+1:1 >&=\\
 <\sum k:1 \leq k \leq n +1 \wedge i = 1^{k-1}A(i)\neq X:1 >
\end{split}
\end{equation}




\section{Question 5.2}
We need to verify the Hoare tripple
\begin{equation}
\begin{split}
 \{ n \in Z \wedge 0 \leq n \} \\
 k:=1 \\
 \{ n in Z \wedge k\in Z \wedge 1 \leq k \leq n+1 \wedge i = 1^{k-1}A(i)\neq X \}
\end{split}
\end{equation}


Using the assignment statement we need to show that

\begin{equation}
\begin{split}
 n \in Z \wedge 0 \leq n \\
 \rightarrow n \in Z \wedge 1 \in Z \wedge 1 \leq 1\leq n+1 \wedge i = 1^{1-1}A(i)\neq x\\
 \rightarrow n \in Z \wedge true \wedge 0 \leq n \wedge true\\
 \rightarrow n \in Z \wedge 0 \leq n\\
\end{split}
 \end{equation}
 
 where 1 is an element of Z by definition 
 
\section{Question 5.3}

We need to prove that 

\begin{equation}
\label{53}
 n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge 1^{k-1}A(i)\neq X \wedge k \leq n \wedge A(k) \neq X \rightarrow  n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge 1^{k-1}A(i)\neq X
\end{equation}

For the first part of the implication 
\begin{equation}
  n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge 1^{k-1}A(i)\neq X \wedge k \leq n \wedge A(k) \neq X
\end{equation}

$k \leq n$ is a subset of $ k \in Z \wedge 1 \leq k \leq n+1$ and $A(k) \neq X$ is just the kase when k = 1 in the term $ 1^{k-1}A(i)\neq X $. Thus Equation \ref{53} becomes  

\begin{equation}
 n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge 1^{k-1}A(i)\neq X \rightarrow  n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge 1^{k-1}A(i)\neq X
\end{equation}

Which is true

\section{Question 5.4}

we need to prove that $[inv \wedge done \rightarrow Q]$

\begin{equation}
 \neg done = k \leq n \wedge A(k) \neq X
\end{equation}

Thus by de Morgans Law

\begin{equation}
done = k > n \vee A(k) = X
\end{equation}

Thus 

\begin{equation}
\begin{split}
n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge 1^{k-1}A(i)\neq X \wedge ( k > n \vee A(k) = X) &\rightarrow\\
n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge 1^{k-1}A(i)\neq X \wedge ( k = n + 1 \vee A(k) = X)
\end{split}
\end{equation}

Since k = n+1 is a subset of k > n

\section{Question 5.5}

Using bounding function

\begin{equation}
 bf = n-k+1
\end{equation}

We know that to gaurentee temination the following tripple has to be valid

\begin{equation}
\begin{split}
\{inv \wedge \neg done ]wedge bf > C\}T\{inv \wedge (bf < C \vee done)\}
\end{split}
\end{equation}

By filling in the post conditions we will apply the assignment statement to reach the precondition.

\begin{equation}
\begin{split}
\{inv \wedge (bf < C \vee done)\} &=\\
n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge i = i^{k-1}A(i) \neq X \wedge (n-k+1<1\vee k>n\vee A(k) = X)
\end{split}
\end{equation}

Applying the assiggnments statement

\begin{equation}
\begin{split}
n \in Z \wedge k +1 \in Z \wedge 1 \leq k+1 \leq n+1 \wedge i = i^{k+1-1}A(i) \neq X \wedge (n-k+1+1<1\vee k+1>n\vee A(k+1) = X)&=\\
n \in Z \wedge k +1 \in Z \wedge 0 \leq k \leq n \wedge  i = i^{k}A(i) \neq X \wedge (n<k-1<1\vee n<k+1\vee A(k+1) = X)&=
(n \in Z \wedge k \in Z \wedge 1 \leq k \leq n+1 \wedge i = i^{k-1}A(i) \neq X) \wedge ( k \leq n \wedge A(k) \neq X) \wedge n-k+1 > 0
\end{split}
\end{equation}










\end{document}


